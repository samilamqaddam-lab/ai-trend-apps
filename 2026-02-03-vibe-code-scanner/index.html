<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîê Vibe Code Scanner ‚Äî Security Check Your AI-Generated Code</title>
    <style>
        :root {
            --bg: #0d1117;
            --card-bg: #161b22;
            --border: #30363d;
            --text: #c9d1d9;
            --text-muted: #8b949e;
            --accent: #58a6ff;
            --red: #f85149;
            --yellow: #d29922;
            --green: #3fb950;
            --purple: #a371f7;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        header {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, var(--red) 0%, var(--yellow) 50%, var(--green) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .subtitle {
            color: var(--text-muted);
            font-size: 1rem;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .anniversary-badge {
            display: inline-block;
            background: linear-gradient(135deg, var(--purple) 0%, var(--accent) 100%);
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: bold;
            margin-top: 1rem;
        }
        
        .quote-box {
            background: var(--card-bg);
            border-left: 4px solid var(--purple);
            padding: 1rem;
            margin: 1.5rem 0;
            border-radius: 0 8px 8px 0;
            font-style: italic;
            color: var(--text-muted);
        }
        
        .quote-author {
            display: block;
            margin-top: 0.5rem;
            font-style: normal;
            color: var(--accent);
            font-size: 0.85rem;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        .panel {
            background: var(--card-bg);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
        }
        
        .panel-title {
            font-size: 1rem;
            color: var(--text-muted);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        textarea {
            width: 100%;
            height: 350px;
            background: var(--bg);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 1rem;
            color: var(--text);
            font-family: 'SF Mono', Monaco, Consolas, monospace;
            font-size: 0.85rem;
            resize: vertical;
        }
        
        textarea:focus {
            outline: none;
            border-color: var(--accent);
        }
        
        .btn {
            background: var(--accent);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            width: 100%;
            margin-top: 1rem;
            transition: opacity 0.2s;
        }
        
        .btn:hover {
            opacity: 0.9;
        }
        
        .results {
            height: 350px;
            overflow-y: auto;
        }
        
        .issue {
            background: var(--bg);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 0.75rem;
            border-left: 4px solid var(--red);
        }
        
        .issue.warning {
            border-left-color: var(--yellow);
        }
        
        .issue.info {
            border-left-color: var(--accent);
        }
        
        .issue-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        .issue-title {
            font-weight: bold;
            color: var(--text);
        }
        
        .severity {
            font-size: 0.7rem;
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
            font-weight: bold;
        }
        
        .severity.critical {
            background: rgba(248, 81, 73, 0.2);
            color: var(--red);
        }
        
        .severity.warning {
            background: rgba(210, 153, 34, 0.2);
            color: var(--yellow);
        }
        
        .severity.info {
            background: rgba(88, 166, 255, 0.2);
            color: var(--accent);
        }
        
        .issue-description {
            font-size: 0.85rem;
            color: var(--text-muted);
            margin-bottom: 0.5rem;
        }
        
        .issue-line {
            font-family: monospace;
            font-size: 0.75rem;
            background: rgba(248, 81, 73, 0.1);
            padding: 0.3rem 0.5rem;
            border-radius: 4px;
            color: var(--red);
            overflow-x: auto;
        }
        
        .no-issues {
            text-align: center;
            padding: 3rem;
            color: var(--green);
        }
        
        .no-issues .icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        
        .stats-bar {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border);
        }
        
        .stat {
            text-align: center;
            flex: 1;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .stat-value.critical { color: var(--red); }
        .stat-value.warning { color: var(--yellow); }
        .stat-value.safe { color: var(--green); }
        
        .stat-label {
            font-size: 0.7rem;
            color: var(--text-muted);
        }
        
        .examples {
            margin-top: 2rem;
        }
        
        .example-buttons {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }
        
        .example-btn {
            background: var(--border);
            color: var(--text-muted);
            border: none;
            padding: 0.4rem 0.8rem;
            border-radius: 6px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .example-btn:hover {
            background: var(--accent);
            color: white;
        }
        
        footer {
            text-align: center;
            margin-top: 2rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border);
            color: var(--text-muted);
            font-size: 0.8rem;
        }
        
        footer a {
            color: var(--accent);
            text-decoration: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üîê Vibe Code Scanner</h1>
            <p class="subtitle">Catch the security issues that vibe coding forgot. Paste your code, find the problems.</p>
            <span class="anniversary-badge">üéÇ Vibe Coding is 1 Year Old!</span>
        </header>
        
        <div class="quote-box">
            "vibe coding turned 1 year old yesterday... what didn't change: security is still an afterthought. moltbook proved it. most vibe coded apps have the same vulnerabilities."
            <span class="quote-author">‚Äî @ejae_dev on X, Feb 3 2026</span>
        </div>
        
        <div class="main-content">
            <div class="panel">
                <h2 class="panel-title">üìù Paste Your Code</h2>
                <textarea id="code-input" placeholder="// Paste your vibe-coded JavaScript, Python, or any code here...

const API_KEY = 'sk-abc123secret';
fetch('https://api.example.com/data', {
  headers: { 'Authorization': API_KEY }
});"></textarea>
                <button class="btn" onclick="scanCode()">üîç Scan for Issues</button>
                
                <div class="examples">
                    <h3 class="panel-title">Try Examples:</h3>
                    <div class="example-buttons">
                        <button class="example-btn" onclick="loadExample('apiKey')">Exposed API Key</button>
                        <button class="example-btn" onclick="loadExample('sql')">SQL Injection</button>
                        <button class="example-btn" onclick="loadExample('auth')">Frontend Auth</button>
                        <button class="example-btn" onclick="loadExample('clean')">Clean Code</button>
                    </div>
                </div>
            </div>
            
            <div class="panel">
                <h2 class="panel-title">üö® Security Issues Found</h2>
                <div class="results" id="results">
                    <div class="no-issues">
                        <div class="icon">üëÜ</div>
                        <p>Paste code and click scan to check for issues</p>
                    </div>
                </div>
                <div class="stats-bar" id="stats-bar" style="display: none;">
                    <div class="stat">
                        <div class="stat-value critical" id="critical-count">0</div>
                        <div class="stat-label">Critical</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value warning" id="warning-count">0</div>
                        <div class="stat-label">Warnings</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value safe" id="lines-count">0</div>
                        <div class="stat-label">Lines Checked</div>
                    </div>
                </div>
            </div>
        </div>
        
        <footer>
            <p>Built for <a href="../index.html">AI Trend Apps</a> ‚Ä¢ Inspired by vibe coding's 1st anniversary üéÇ</p>
            <p>Remember: Ship fast, but don't ship auth tokens in the frontend! üöÄ</p>
        </footer>
    </div>
    
    <script>
        const securityRules = [
            {
                name: "Exposed API Key",
                severity: "critical",
                pattern: /(api[_-]?key|apikey|secret[_-]?key|auth[_-]?token|access[_-]?token|bearer)\s*[:=]\s*['"`][a-zA-Z0-9_\-]{10,}/gi,
                description: "Hardcoded API keys can be extracted and abused. Use environment variables.",
                example: "api_key = 'sk-abc123...'"
            },
            {
                name: "Hardcoded Password",
                severity: "critical",
                pattern: /(password|passwd|pwd)\s*[:=]\s*['"`][^'"`]{3,}/gi,
                description: "Never hardcode passwords. Use secure credential management.",
                example: "password = 'secret123'"
            },
            {
                name: "Private Key Detected",
                severity: "critical",
                pattern: /-----BEGIN\s+(RSA\s+)?PRIVATE\s+KEY-----/gi,
                description: "Private keys should never be in code! Use secure key management.",
                example: "-----BEGIN PRIVATE KEY-----"
            },
            {
                name: "AWS Credentials",
                severity: "critical",
                pattern: /(AKIA[0-9A-Z]{16}|aws[_-]?(secret[_-]?)?access[_-]?key)/gi,
                description: "AWS credentials exposed! Use IAM roles or AWS Secrets Manager.",
                example: "AKIAIOSFODNN7EXAMPLE"
            },
            {
                name: "SQL Injection Risk",
                severity: "critical",
                pattern: /(execute|query|raw)\s*\([^)]*(\+|concat|\$\{|f['"]|%s|%d)/gi,
                description: "String concatenation in SQL queries is dangerous. Use parameterized queries.",
                example: "query('SELECT * FROM users WHERE id=' + userId)"
            },
            {
                name: "eval() Usage",
                severity: "critical",
                pattern: /\beval\s*\(/gi,
                description: "eval() executes arbitrary code. This is a major security risk.",
                example: "eval(userInput)"
            },
            {
                name: "innerHTML Assignment",
                severity: "warning",
                pattern: /\.innerHTML\s*=/gi,
                description: "innerHTML can lead to XSS. Use textContent or sanitize inputs.",
                example: "element.innerHTML = userInput"
            },
            {
                name: "document.write()",
                severity: "warning",
                pattern: /document\.write\s*\(/gi,
                description: "document.write can be exploited for XSS attacks.",
                example: "document.write(data)"
            },
            {
                name: "No Rate Limiting",
                severity: "warning",
                pattern: /fetch\s*\([^)]+\)|axios\.(get|post|put|delete)|http\.(get|post)/gi,
                description: "API calls without visible rate limiting. Consider adding throttling.",
                example: "fetch('/api/data')",
                checkContext: (code) => !/(rate[_-]?limit|throttle|debounce)/i.test(code)
            },
            {
                name: "Hardcoded localhost/URL",
                severity: "info",
                pattern: /(http:\/\/localhost|127\.0\.0\.1):\d+/gi,
                description: "Hardcoded development URLs should use environment variables.",
                example: "http://localhost:3000"
            },
            {
                name: "console.log in Production",
                severity: "info",
                pattern: /console\.(log|debug|info)\s*\(/gi,
                description: "Remove debug logs before production. They can leak sensitive data.",
                example: "console.log(userData)"
            },
            {
                name: "JWT in localStorage",
                severity: "warning",
                pattern: /localStorage\.(setItem|getItem)\s*\(\s*['"`](token|jwt|auth)/gi,
                description: "Storing JWTs in localStorage is vulnerable to XSS. Consider httpOnly cookies.",
                example: "localStorage.setItem('token', jwt)"
            },
            {
                name: "CORS Wildcard",
                severity: "warning",
                pattern: /(Access-Control-Allow-Origin|cors).*['"`]\*['"`]/gi,
                description: "CORS wildcard (*) allows any origin. Restrict to trusted domains.",
                example: "Access-Control-Allow-Origin: *"
            },
            {
                name: "Disabled HTTPS",
                severity: "warning",
                pattern: /(rejectUnauthorized|strictSSL|verify)\s*[:=]\s*(false|0)/gi,
                description: "Disabling SSL verification exposes you to MITM attacks.",
                example: "rejectUnauthorized: false"
            },
            {
                name: "exec/spawn Shell",
                severity: "critical",
                pattern: /\b(exec|spawn|system|shell_exec|popen)\s*\(/gi,
                description: "Shell execution with user input is extremely dangerous.",
                example: "exec('rm -rf ' + userInput)"
            }
        ];
        
        const examples = {
            apiKey: `// Typical vibe coding mistake - exposed keys!
const OPENAI_KEY = 'sk-abc123secretkey456';
const STRIPE_SECRET = 'sk_live_realstripekey789';

async function getCompletion(prompt) {
  const response = await fetch('https://api.openai.com/v1/completions', {
    headers: {
      'Authorization': 'Bearer ' + OPENAI_KEY,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({ prompt, model: 'gpt-4' })
  });
  return response.json();
}`,
            sql: `// SQL injection waiting to happen
const mysql = require('mysql');

app.get('/user', (req, res) => {
  const userId = req.query.id;
  
  // üö® NEVER do this!
  db.query('SELECT * FROM users WHERE id = ' + userId, (err, results) => {
    res.json(results);
  });
  
  // Also bad:
  const name = req.body.name;
  db.execute(\`DELETE FROM users WHERE name = '\${name}'\`);
});`,
            auth: `// Frontend auth disaster
const password = 'admin123';

// Storing sensitive tokens in localStorage
function login(user, pass) {
  if (user === 'admin' && pass === password) {
    const token = generateToken();
    localStorage.setItem('authToken', token);
    localStorage.setItem('jwt', token);
  }
}

// No rate limiting on API calls
async function fetchUserData() {
  const token = localStorage.getItem('jwt');
  return fetch('/api/users', {
    headers: { 'Authorization': token }
  });
}

// Dangerous innerHTML
document.getElementById('output').innerHTML = userData.bio;`,
            clean: `// Properly secured code example
import { createClient } from '@supabase/supabase-js';

// ‚úÖ Environment variables for secrets
const supabase = createClient(
  process.env.SUPABASE_URL,
  process.env.SUPABASE_ANON_KEY
);

// ‚úÖ Parameterized queries
async function getUser(userId) {
  const { data, error } = await supabase
    .from('users')
    .select('*')
    .eq('id', userId);
  return data;
}

// ‚úÖ Safe text content
function displayMessage(text) {
  document.getElementById('output').textContent = text;
}`
        };
        
        function loadExample(type) {
            document.getElementById('code-input').value = examples[type];
            scanCode();
        }
        
        function scanCode() {
            const code = document.getElementById('code-input').value;
            const results = document.getElementById('results');
            const statsBar = document.getElementById('stats-bar');
            
            const issues = [];
            const lines = code.split('\n');
            
            securityRules.forEach(rule => {
                // Check context condition if exists
                if (rule.checkContext && !rule.checkContext(code)) {
                    return;
                }
                
                let match;
                const regex = new RegExp(rule.pattern.source, rule.pattern.flags);
                
                while ((match = regex.exec(code)) !== null) {
                    // Find line number
                    const beforeMatch = code.substring(0, match.index);
                    const lineNum = (beforeMatch.match(/\n/g) || []).length + 1;
                    
                    issues.push({
                        ...rule,
                        line: lineNum,
                        match: match[0].substring(0, 50) + (match[0].length > 50 ? '...' : '')
                    });
                }
            });
            
            // Count by severity
            const critical = issues.filter(i => i.severity === 'critical').length;
            const warning = issues.filter(i => i.severity === 'warning').length;
            
            // Update stats
            document.getElementById('critical-count').textContent = critical;
            document.getElementById('warning-count').textContent = warning;
            document.getElementById('lines-count').textContent = lines.length;
            statsBar.style.display = 'flex';
            
            if (issues.length === 0) {
                results.innerHTML = `
                    <div class="no-issues">
                        <div class="icon">‚úÖ</div>
                        <p>No obvious security issues detected!</p>
                        <p style="font-size: 0.8rem; margin-top: 0.5rem; color: var(--text-muted)">
                            Note: This is a basic scan. Always do thorough security reviews.
                        </p>
                    </div>
                `;
                return;
            }
            
            results.innerHTML = issues.map(issue => `
                <div class="issue ${issue.severity === 'warning' ? 'warning' : ''} ${issue.severity === 'info' ? 'info' : ''}">
                    <div class="issue-header">
                        <span class="issue-title">${issue.name}</span>
                        <span class="severity ${issue.severity}">${issue.severity.toUpperCase()}</span>
                    </div>
                    <p class="issue-description">${issue.description}</p>
                    <div class="issue-line">Line ${issue.line}: ${escapeHtml(issue.match)}</div>
                </div>
            `).join('');
        }
        
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
    </script>
</body>
</html>
